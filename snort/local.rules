# $Id: local.rules,v 1.11 2004/07/23 20:15:44 bmc Exp $
# ----------------
# LOCAL RULES
# ----------------
# This file intentionally does not come with signatures.  Put your local
# additions here.
# 1 - Scan SYN (Reconnaissance)
alert tcp any any -> any any (msg:"SYN portscan detected"; flags:S; detection_filter: track by_src, count 20, seconds 10; priority:3; sid:1000001; rev:1;)

# 2 - Brute force SSH
alert tcp any any -> any 22 (msg:"SSH brute force"; flow:to_server,established; detection_filter: track by_src, count 5, seconds 60; priority:1; sid:1000002; rev:1;)

# 3 - Requête HTTP suspecte (exploit PHP)
alert tcp any any -> any 80 (msg:"HTTP exploit attempt"; content:"exploit"; http_uri; nocase; priority:2; sid:1000003; rev:1;)

# 4 - Téléchargement exécutable suspect (.exe)
alert tcp any any -> any 80 (msg:"HTTP Suspicious EXE request"; flow:to_server,established; content:".exe"; http_uri; nocase; priority:2; sid:1000106; rev:1;)

# 5 - ICMP flood (DoS)
alert icmp any any -> any any (msg:"ICMP flood detected"; detection_filter: track by_src, count 20, seconds 10; priority:1; sid:1000005; rev:1;)

# 6 - Tentative SQL injection simple
alert tcp any any -> any 80 (msg:"WEB SQL Injection attempt"; flow:to_server,established; content:"' OR '1'='1"; nocase; priority:1; sid:1000017; rev:1;)

