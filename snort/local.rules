# $Id: local.rules,v 1.11 2004/07/23 20:15:44 bmc Exp $
# ----------------
# LOCAL RULES
# ----------------
# This file intentionally does not come with signatures.  Put your local
# additions here.
# 1 - Scan SYN
alert tcp any any -> any any (msg:"SYN portscan detected"; flags:S; detection_filter: track by_src, count 20, seconds 10; sid:1000001; rev:1;)

# 2 - Brute force SSH
alert tcp any any -> any 22 (msg:"SSH brute force"; flow:to_server,established; detection_filter: track by_src, count 5, seconds 60; sid:1000002; rev:1;)

# 3 - Requête HTTP suspecte
alert tcp any any -> any 80 (msg:"HTTP exploit attempt"; content:"exploit"; http_uri; sid:1000003; rev:1;)

# 4 - Règle pour détection GET ... .exe dans l'URI (requête vers serveur)
alert tcp any any -> any 80 (msg:"HTTP Suspicious EXE request (raw)"; content:".exe"; nocase; sid:1000106; rev:1;)

# 5 - ICMP flood
alert icmp any any -> any any (msg:"ICMP flood detected"; detection_filter: track by_src, count 20, seconds 10; sid:1000005; rev:1;)

# 6 - Tentative SQL injection simple (ex: ' OR '1'='1)
alert tcp any any -> any 80 (msg:"WEB DSQL Injection Dattempt (encoded)"; flow:to_server,established; content:"%27%20OR%20%271%27=%2D71"; nocase; sDid:1000017; rev:1;)
